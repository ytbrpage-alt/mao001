(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{9311:function(e,t,n){Promise.resolve().then(n.bind(n,6117))},5302:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},407:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},3044:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(9763).Z)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]])},1723:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},9397:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2369:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6117:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var s=n(7437),a=n(9376),i=n(521),l=n(2369),r=n(9397),c=n(3044),u=n(1723),d=n(5302),o=n(407),h=n(5859),m=n(9102),f=n(4362);function x(){var e;let t=(0,a.useRouter)(),{user:n}=(0,f.aC)(),{evaluations:x,createEvaluation:p}=(0,h.q)(),g=Object.values(x),N=g.sort((e,t)=>new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime()).slice(0,5),y={total:g.length,pending:g.filter(e=>"in_progress"===e.status||"draft"===e.status).length,completed:g.filter(e=>"completed"===e.status).length},v=e=>{switch(e){case"draft":return(0,s.jsx)("span",{className:"badge-warning",children:"Rascunho"});case"in_progress":return(0,s.jsx)("span",{className:"badge-info",children:"Em Andamento"});case"completed":return(0,s.jsx)("span",{className:"badge-success",children:"Conclu\xedda"});default:return null}};return(0,s.jsxs)("main",{className:"container-mobile min-h-screen pb-24 lg:pb-12",children:[(0,s.jsx)("header",{className:"pt-6 pb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-brand-500 rounded-xl flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-xl font-bold",children:"MA"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-neutral-900",children:"M\xe3os Amigas"}),(0,s.jsx)("p",{className:"text-sm text-neutral-500",children:"Sistema de Avalia\xe7\xe3o"})]})]}),(0,s.jsxs)("div",{className:"hidden sm:flex items-center gap-3 bg-white rounded-full pl-4 pr-2 py-2 shadow-soft",children:[(0,s.jsxs)("span",{className:"text-sm text-neutral-600",children:["Ol\xe1, ",(0,s.jsx)("span",{className:"font-medium",suppressHydrationWarning:!0,children:(null==n?void 0:null===(e=n.fullName)||void 0===e?void 0:e.split(" ")[0])||"Avaliador"})]}),(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-100 flex items-center justify-center",children:(0,s.jsx)(l.Z,{className:"w-4 h-4 text-brand-600"})})]})]})}),(0,s.jsxs)("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,s.jsx)("section",{children:(0,s.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{let e=p("evaluator-1");t.push("/avaliacao/".concat(e))},className:"w-full btn-primary gap-3 text-lg py-4",children:[(0,s.jsx)(r.Z,{className:"w-6 h-6"}),"Nova Avalia\xe7\xe3o"]})}),(0,s.jsxs)("section",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"card text-center",children:[(0,s.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 bg-brand-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(c.Z,{className:"w-5 h-5 text-brand-600"})}),(0,s.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:y.total}),(0,s.jsx)("p",{className:"text-xs text-neutral-500",children:"Total"})]}),(0,s.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"card text-center",children:[(0,s.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 bg-warning-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(u.Z,{className:"w-5 h-5 text-warning-600"})}),(0,s.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:y.pending}),(0,s.jsx)("p",{className:"text-xs text-neutral-500",children:"Pendentes"})]}),(0,s.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"card text-center",children:[(0,s.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 bg-success-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(d.Z,{className:"w-5 h-5 text-success-600"})}),(0,s.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:y.completed}),(0,s.jsx)("p",{className:"text-xs text-neutral-500",children:"Conclu\xeddas"})]})]}),(0,s.jsxs)("button",{onClick:()=>t.push("/avaliacao"),className:"hidden lg:flex w-full btn-secondary gap-2",children:[(0,s.jsx)(c.Z,{className:"w-5 h-5"}),"Ver Todas as Avalia\xe7\xf5es"]})]}),(0,s.jsxs)("section",{className:"lg:col-span-2 mt-8 lg:mt-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-neutral-900",children:"Avalia\xe7\xf5es Recentes"}),(0,s.jsx)("button",{onClick:()=>t.push("/avaliacao"),className:"text-sm text-brand-600 hover:text-brand-700 font-medium lg:hidden",children:"Ver todas"})]}),0===N.length?(0,s.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"card text-center py-12 lg:py-16",children:[(0,s.jsx)(c.Z,{className:"w-16 h-16 mx-auto mb-4 text-neutral-300"}),(0,s.jsx)("p",{className:"text-neutral-500 font-medium",children:"Nenhuma avalia\xe7\xe3o ainda"}),(0,s.jsx)("p",{className:"text-sm text-neutral-400 mt-1",children:'Clique em "Nova Avalia\xe7\xe3o" para come\xe7ar'})]}):(0,s.jsx)("div",{className:"space-y-3 lg:grid lg:grid-cols-2 lg:gap-4 lg:space-y-0",children:N.map((e,n)=>(0,s.jsx)(i.E.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*n},whileHover:{scale:1.01},onClick:()=>t.push("/avaliacao/".concat(e.id)),className:"card w-full text-left touch-feedback hover:shadow-medium transition-shadow",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-brand-100 flex items-center justify-center text-brand-600 font-semibold flex-shrink-0",children:(e.patient.preferredName||e.patient.fullName||"P")[0].toUpperCase()}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsx)("p",{className:"font-medium text-neutral-900 truncate",children:e.patient.fullName||"Paciente n\xe3o informado"}),v(e.status)]}),(0,s.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5",children:(0,m.zg)(e.updatedAt)})]}),(0,s.jsx)(o.Z,{className:"w-5 h-5 text-neutral-300 flex-shrink-0 hidden sm:block"})]})},e.id))})]})]})]})}},4362:function(e,t,n){"use strict";n.d(t,{Ho:function(){return u},QL:function(){return o},aC:function(){return d}});var s=n(7437),a=n(2265),i=n(9376),l=n(4270);let r=(0,a.createContext)(null),c=["/login","/forgot-pin","/"];function u(e){let{children:t}=e,n=(0,i.useRouter)(),u=(0,i.usePathname)(),d=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t(!0)},[]),e}(),o=(0,l.t)(),[h,m]=(0,a.useState)(!1),[f,x]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!d)return;let e=setTimeout(()=>{(0,l.v)().then(()=>{g(!0)})},100);return()=>clearTimeout(e)},[d]),(0,a.useEffect)(()=>{if(!p)return;let e=()=>{if(!o.checkSession()&&!c.includes(u)){n.push("/login");return}if(o.session){let e=new Date(o.session.expiresAt).getTime()-Date.now();x(e),m(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[p,u,n,o]),(0,a.useEffect)(()=>{if(!o.isAuthenticated)return;let e=()=>{o.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[o.isAuthenticated,o]),(0,a.useEffect)(()=>{if(!p)return;let e=c.includes(u);o.isAuthenticated||e?o.isAuthenticated&&"/login"===u&&n.push("/"):n.push("/login")},[p,o.isAuthenticated,u,n]);let N=(0,a.useCallback)(async e=>{let t=await o.loginWithPin(e);return t.success&&n.push("/"),t},[o,n]),y=(0,a.useCallback)(()=>{o.logout(),n.push("/login")},[o,n]),v=(0,a.useCallback)(()=>{o.refreshSession(),m(!1)},[o]),j=(0,a.useCallback)(e=>o.hasPermission(e),[o]),w={user:o.getCurrentUser(),isAuthenticated:o.isAuthenticated,isLoading:!p,permissions:o.getPermissions(),login:N,logout:y,hasPermission:j,showSessionWarning:h,sessionExpiresIn:f,extendSession:v};return(0,s.jsx)(r.Provider,{value:w,children:t})}function d(){let e=(0,a.useContext)(r);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function o(e){let{isAuthenticated:t,isLoading:n,hasPermission:s}=d(),l=(0,i.useRouter)();return(0,a.useEffect)(()=>{if(!n){if(!t){l.push("/login");return}e&&!s(e)&&l.push("/unauthorized")}},[t,n,e,s,l]),{isLoading:n,isAuthorized:t&&(!e||s(e))}}},9102:function(e,t,n){"use strict";n.d(t,{Fw:function(){return u},p6:function(){return r},zg:function(){return c}});var s=n(936),a=n(4122),i=n(8442),l=n(4862);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd/MM/yyyy",n="string"==typeof e?(0,s.D)(e):e;return(0,a.WU)(n,t,{locale:l.F})}function c(e){let t="string"==typeof e?(0,s.D)(e):e;return(0,i.Q)(t,{locale:l.F,addSuffix:!0})}function u(e){let t=new Date,n=t.getFullYear()-e.getFullYear(),s=t.getMonth()-e.getMonth();return(s<0||0===s&&t.getDate()<e.getDate())&&n--,n}},936:function(e,t,n){"use strict";n.d(t,{D:function(){return a}});var s=n(8198);function a(e,t){var n;let a,m;let f=null!==(n=null==t?void 0:t.additionalDigits)&&void 0!==n?n:2,x=function(e){let t;let n={},s=e.split(i.dateTimeDelimiter);if(s.length>2)return n;if(/:/.test(s[0])?t=s[0]:(n.date=s[0],t=s[1],i.timeZoneDelimiter.test(n.date)&&(n.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length))),t){let e=i.timezone.exec(t);e?(n.time=t.replace(e[1],""),n.timezone=e[1]):n.time=t}return n}(e);if(x.date){let e=function(e,t){let n=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(n);if(!s)return{year:NaN,restDateString:""};let a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:null===i?a:100*i,restDateString:e.slice((s[1]||s[2]).length)}}(x.date,f);a=function(e,t){if(null===t)return new Date(NaN);let n=e.match(l);if(!n)return new Date(NaN);let s=!!n[4],a=u(n[1]),i=u(n[2])-1,r=u(n[3]),c=u(n[4]),d=u(n[5])-1;if(s)return c>=1&&c<=53&&d>=0&&d<=6?function(e,t,n){let s=new Date(0);s.setUTCFullYear(e,0,4);let a=s.getUTCDay()||7;return s.setUTCDate(s.getUTCDate()+((t-1)*7+n+1-a)),s}(t,c,d):new Date(NaN);{let e=new Date(0);return i>=0&&i<=11&&r>=1&&r<=(o[i]||(h(t)?29:28))&&a>=1&&a<=(h(t)?366:365)?(e.setUTCFullYear(t,i,Math.max(a,r)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);let p=a.getTime(),g=0;if(x.time&&isNaN(g=function(e){let t=e.match(r);if(!t)return NaN;let n=d(t[1]),a=d(t[2]),i=d(t[3]);return(24===n?0===a&&0===i:i>=0&&i<60&&a>=0&&a<60&&n>=0&&n<25)?n*s.vh+a*s.yJ+1e3*i:NaN}(x.time)))return new Date(NaN);if(x.timezone){if(isNaN(m=function(e){if("Z"===e)return 0;let t=e.match(c);if(!t)return 0;let n="+"===t[1]?-1:1,a=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return i>=0&&i<=59?n*(a*s.vh+i*s.yJ):NaN}(x.timezone)))return new Date(NaN)}else{let e=new Date(p+g),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(p+g+m)}let i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},l=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,r=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,c=/^([+-])(\d{2})(?::?(\d{2}))?$/;function u(e){return e?parseInt(e):1}function d(e){return e&&parseFloat(e.replace(",","."))||0}let o=[31,null,31,30,31,30,31,31,30,31,30,31];function h(e){return e%400==0||e%4==0&&e%100!=0}}},function(e){e.O(0,[7230,4875,2859,4122,9179,4270,5859,2971,2117,1744],function(){return e(e.s=9311)}),_N_E=e.O()}]);