(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4665],{91826:function(e,t,n){Promise.resolve().then(n.bind(n,83041))},22252:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(39763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},87769:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(39763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},42208:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},15863:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(39763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99376:function(e,t,n){"use strict";var s=n(35475);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})},83041:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var s=n(57437),a=n(2265),i=n(40521),r=n(48614),l=n(87769),c=n(42208),o=n(22252),u=n(15863),d=n(14362),h=n(91001);let m={light:10,medium:20,heavy:40,success:[10,50,10],warning:[20,50,20,50,20],error:[50,100,50]};function f(){return{vibrate:(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";if("vibrate"in navigator)try{navigator.vibrate(m[e])}catch(e){}},[]),vibratePattern:(0,a.useCallback)(e=>{if("vibrate"in navigator)try{navigator.vibrate(e)}catch(e){}},[]),stopVibration:(0,a.useCallback)(()=>{if("vibrate"in navigator)try{navigator.vibrate(0)}catch(e){}},[])}}function x(e){let{length:t=6,value:n,onChange:l,onComplete:c,error:o,disabled:u=!1,autoFocus:d=!0,masked:m=!0}=e,{vibrate:x}=f(),p=(0,a.useRef)([]),[g,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{d&&p.current[0]&&p.current[0].focus()},[d]),(0,a.useEffect)(()=>{n.length===t&&c&&c(n)},[n,t,c]);let v=(e,s)=>{if(u||!/^\d*$/.test(s))return;let a=n.split("");if(a[e]=s,l(a.join("").slice(0,t)),x("light"),s&&e<t-1){var i;null===(i=p.current[e+1])||void 0===i||i.focus()}},b=(e,s)=>{var a,i,r;if(!u){if("Backspace"===s.key){if(s.preventDefault(),n[e]){let t=n.split("");t[e]="",l(t.join(""))}else if(e>0){null===(a=p.current[e-1])||void 0===a||a.focus();let t=n.split("");t[e-1]="",l(t.join(""))}x("light")}else"ArrowLeft"===s.key&&e>0?null===(i=p.current[e-1])||void 0===i||i.focus():"ArrowRight"===s.key&&e<t-1&&(null===(r=p.current[e+1])||void 0===r||r.focus())}},j=e=>{if(e.preventDefault(),u)return;let n=e.clipboardData.getData("text").replace(/\D/g,"").slice(0,t);if(n){var s;l(n),x("medium");let e=Math.min(n.length,t-1);null===(s=p.current[e])||void 0===s||s.focus()}},w=e=>{var t;y(e),null===(t=p.current[e])||void 0===t||t.select()},N=()=>{y(null)};return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("div",{className:"flex justify-center gap-2 sm:gap-3",children:Array.from({length:t}).map((e,t)=>{let a=void 0!==n[t]&&""!==n[t],l=g===t,c=!!o;return(0,s.jsxs)(i.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.05*t},className:"relative",children:[(0,s.jsx)("input",{ref:e=>{p.current[t]=e},type:m?"password":"text",inputMode:"numeric",pattern:"\\d*",maxLength:1,value:n[t]||"",onChange:e=>v(t,e.target.value),onKeyDown:e=>b(t,e),onPaste:j,onFocus:()=>w(t),onBlur:N,disabled:u,autoComplete:"one-time-code",className:(0,h.cn)("w-12 h-14 sm:w-14 sm:h-16 text-center text-2xl font-bold","rounded-xl border-2 transition-all duration-200","focus:outline-none focus:ring-0",u&&"opacity-50 cursor-not-allowed bg-neutral-100",c?"border-danger-500 bg-danger-50":l?"border-brand-500 bg-white shadow-md":a?"border-brand-300 bg-brand-50":"border-neutral-300 bg-white")}),(0,s.jsx)(r.M,{children:a&&m&&(0,s.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,s.jsx)("div",{className:"w-3 h-3 bg-brand-500 rounded-full"})})})]},t)})}),(0,s.jsx)(r.M,{children:o&&(0,s.jsx)(i.E.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-sm text-danger-600 text-center",children:o})})]})}var p=n(39763);let g=(0,p.Z)("Delete",[["path",{d:"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z",key:"1oy587"}],["line",{x1:"18",x2:"12",y1:"9",y2:"15",key:"1olkx5"}],["line",{x1:"12",x2:"18",y1:"9",y2:"15",key:"1n50pc"}]]),y=(0,p.Z)("Fingerprint",[["path",{d:"M2 12C2 6.5 6.5 2 12 2a10 10 0 0 1 8 4",key:"1jc9o5"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12c0-.7.12-1.37.34-2",key:"1mxgy1"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2c0 .47 0 1.17-.02 2",key:"1fgabc"}]]);function v(e){let{onDigit:t,onDelete:n,onBiometric:a,disabled:r=!1,showBiometric:l=!1}=e,{vibrate:c}=f(),o=e=>{r||(c("light"),t(e))},u=()=>{r||(c("medium"),n())},d=()=>{!r&&a&&(c("medium"),a())},m=(0,h.cn)("w-20 h-20 sm:w-24 sm:h-24 rounded-full","flex items-center justify-center","text-2xl sm:text-3xl font-semibold text-neutral-800","bg-white border border-neutral-200","active:bg-neutral-100 active:scale-95","transition-all duration-100","touch-feedback",r&&"opacity-50 cursor-not-allowed");return(0,s.jsx)("div",{className:"flex flex-col items-center gap-3 sm:gap-4",children:[["1","2","3"],["4","5","6"],["7","8","9"],[l?"bio":"","0","del"]].map((e,t)=>(0,s.jsx)("div",{className:"flex gap-3 sm:gap-4",children:e.map((e,t)=>""===e?(0,s.jsx)("div",{className:"w-20 h-20 sm:w-24 sm:h-24"},t):"del"===e?(0,s.jsx)(i.E.button,{whileTap:{scale:.95},onClick:u,disabled:r,className:(0,h.cn)(m,"bg-neutral-100"),"aria-label":"Apagar",children:(0,s.jsx)(g,{className:"w-6 h-6 sm:w-7 sm:h-7"})},t):"bio"===e?(0,s.jsx)(i.E.button,{whileTap:{scale:.95},onClick:d,disabled:r||!a,className:(0,h.cn)(m,"bg-brand-50 text-brand-600"),"aria-label":"Biometria",children:(0,s.jsx)(y,{className:"w-7 h-7 sm:w-8 sm:h-8"})},t):(0,s.jsx)(i.E.button,{whileTap:{scale:.95},onClick:()=>o(e),disabled:r,className:m,children:e},t))},t))})}function b(){let{login:e,isLoading:t}=(0,d.aC)(),{vibrate:n}=f(),[h,m]=(0,a.useState)(""),[p,g]=(0,a.useState)(null),[y,b]=(0,a.useState)(null),[j,w]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),E=(0,a.useCallback)(e=>{m(e),g(null)},[]),C=(0,a.useCallback)(e=>{h.length<6&&E(h+e)},[h,E]),M=(0,a.useCallback)(()=>{E(h.slice(0,-1))},[h,E]),P=(0,a.useCallback)(async t=>{if(!N){k(!0),g(null);try{let i=await e(t);if(i.success)n("success");else{var s,a;n("error"),g((null===(s=i.error)||void 0===s?void 0:s.message)||"PIN inv\xe1lido"),b(null!==(a=i.remainingAttempts)&&void 0!==a?a:null),m("")}}catch(e){n("error"),g("Erro ao fazer login. Tente novamente."),m("")}finally{k(!1)}}},[e,N,n]);return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-brand-500 to-brand-700 flex flex-col lg:flex-row lg:items-center lg:justify-center",children:[(0,s.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"hidden lg:flex lg:flex-col lg:items-center lg:justify-center lg:w-1/2 lg:p-12",children:[(0,s.jsx)("div",{className:"w-32 h-32 bg-white rounded-3xl shadow-strong flex items-center justify-center mb-6",children:(0,s.jsx)("span",{className:"text-6xl",children:"\uD83E\uDD1D"})}),(0,s.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"M\xe3os Amigas"}),(0,s.jsx)("p",{className:"text-xl text-brand-100",children:"Sistema de Avalia\xe7\xe3o"}),(0,s.jsx)("p",{className:"text-brand-200 mt-4 text-center max-w-md",children:"Gerencie avalia\xe7\xf5es domiciliares com efici\xeancia e profissionalismo"})]}),(0,s.jsxs)(i.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"lg:hidden pt-safe-top px-6 py-8 text-center",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-white rounded-2xl shadow-strong flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-4xl",children:"\uD83E\uDD1D"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"M\xe3os Amigas"}),(0,s.jsx)("p",{className:"text-brand-100 mt-1",children:"Sistema de Avalia\xe7\xe3o"})]}),(0,s.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex-1 bg-white rounded-t-3xl lg:rounded-3xl px-6 py-8 shadow-strong lg:flex-none lg:w-full lg:max-w-md lg:mx-auto",children:(0,s.jsxs)("div",{className:"max-w-sm mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-neutral-900",children:"Digite seu PIN"}),(0,s.jsx)("p",{className:"text-neutral-500 mt-1",children:"Use seu PIN de 6 d\xedgitos para acessar"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,s.jsx)(x,{value:h,onChange:E,onComplete:P,error:p||void 0,disabled:t||N,masked:!j}),(0,s.jsx)("button",{type:"button",onClick:()=>w(!j),className:"p-2 text-neutral-400 hover:text-neutral-600","aria-label":j?"Ocultar PIN":"Mostrar PIN",children:j?(0,s.jsx)(l.Z,{className:"w-5 h-5"}):(0,s.jsx)(c.Z,{className:"w-5 h-5"})})]}),(0,s.jsx)(r.M,{children:null!==y&&y<5&&(0,s.jsxs)(i.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"flex items-center justify-center gap-2 text-warning-600 text-sm",children:[(0,s.jsx)(o.Z,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:[y," tentativa",1!==y?"s":""," restante",1!==y?"s":""]})]})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(v,{onDigit:C,onDelete:M,disabled:t||N})}),(0,s.jsx)(r.M,{children:(t||N)&&(0,s.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-6 flex flex-col items-center gap-3",children:[(0,s.jsx)(u.Z,{className:"w-8 h-8 text-brand-500 animate-spin"}),(0,s.jsx)("p",{className:"text-neutral-600",children:"Verificando..."})]})})}),(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsx)("button",{type:"button",className:"text-brand-600 text-sm font-medium hover:underline",onClick:()=>{alert("Entre em contato com o administrador para redefinir seu PIN")},children:"Esqueceu seu PIN?"})})]})}),(0,s.jsx)("div",{className:"lg:hidden bg-white px-6 pb-safe-bottom py-4 text-center",children:(0,s.jsxs)("p",{className:"text-xs text-neutral-400",children:["M\xe3os Amigas Home Care \xa9 ",new Date().getFullYear()]})})]})}},14362:function(e,t,n){"use strict";n.d(t,{Ho:function(){return o},QL:function(){return d},aC:function(){return u}});var s=n(57437),a=n(2265),i=n(99376),r=n(64270);let l=(0,a.createContext)(null),c=["/login","/forgot-pin","/"];function o(e){let{children:t}=e,n=(0,i.useRouter)(),o=(0,i.usePathname)(),u=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t(!0)},[]),e}(),d=(0,r.t)(),[h,m]=(0,a.useState)(!1),[f,x]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!u)return;let e=setTimeout(()=>{(0,r.v)().then(()=>{g(!0)})},100);return()=>clearTimeout(e)},[u]),(0,a.useEffect)(()=>{if(!p)return;let e=()=>{if(!d.checkSession()&&!c.includes(o)){n.push("/login");return}if(d.session){let e=new Date(d.session.expiresAt).getTime()-Date.now();x(e),m(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[p,o,n,d]),(0,a.useEffect)(()=>{if(!d.isAuthenticated)return;let e=()=>{d.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[d.isAuthenticated,d]),(0,a.useEffect)(()=>{if(!p)return;let e=c.includes(o);d.isAuthenticated||e?d.isAuthenticated&&"/login"===o&&n.push("/"):n.push("/login")},[p,d.isAuthenticated,o,n]);let y=(0,a.useCallback)(async e=>{let t=await d.loginWithPin(e);return t.success&&n.push("/"),t},[d,n]),v=(0,a.useCallback)(()=>{d.logout(),n.push("/login")},[d,n]),b=(0,a.useCallback)(()=>{d.refreshSession(),m(!1)},[d]),j=(0,a.useCallback)(e=>d.hasPermission(e),[d]),w={user:d.getCurrentUser(),isAuthenticated:d.isAuthenticated,isLoading:!p,permissions:d.getPermissions(),login:y,logout:v,hasPermission:j,showSessionWarning:h,sessionExpiresIn:f,extendSession:b};return(0,s.jsx)(l.Provider,{value:w,children:t})}function u(){let e=(0,a.useContext)(l);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function d(e){let{isAuthenticated:t,isLoading:n,hasPermission:s}=u(),r=(0,i.useRouter)();return(0,a.useEffect)(()=>{if(!n){if(!t){r.push("/login");return}e&&!s(e)&&r.push("/unauthorized")}},[t,n,e,s,r]),{isLoading:n,isAuthorized:t&&(!e||s(e))}}},91001:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var s=n(61994),a=n(53335);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,s.W)(t))}},48614:function(e,t,n){"use strict";n.d(t,{M:function(){return g}});var s=n(57437),a=n(2265),i=n(58881),r=n(53576),l=n(64252),c=n(45750);class o extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:n}=e,i=(0,a.useId)(),r=(0,a.useRef)(null),l=(0,a.useRef)({width:0,height:0,top:0,left:0}),{nonce:u}=(0,a.useContext)(c._);return(0,a.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:a}=l.current;if(n||!r.current||!e||!t)return;r.current.dataset.motionPopId=i;let c=document.createElement("style");return u&&(c.nonce=u),document.head.appendChild(c),c.sheet&&c.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(s,"px !important;\n            left: ").concat(a,"px !important;\n          }\n        ")),()=>{document.head.removeChild(c)}},[n]),(0,s.jsx)(o,{isPresent:n,childRef:r,sizeRef:l,children:a.cloneElement(t,{ref:r})})}let d=e=>{let{children:t,initial:n,isPresent:i,onExitComplete:c,custom:o,presenceAffectsLayout:d,mode:m}=e,f=(0,r.h)(h),x=(0,a.useId)(),p=(0,a.useCallback)(e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;c&&c()},[f,c]),g=(0,a.useMemo)(()=>({id:x,initial:n,isPresent:i,custom:o,onExitComplete:p,register:e=>(f.set(e,!1),()=>f.delete(e))}),d?[Math.random(),p]:[i,p]);return(0,a.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[i]),a.useEffect(()=>{i||f.size||!c||c()},[i]),"popLayout"===m&&(t=(0,s.jsx)(u,{isPresent:i,children:t})),(0,s.jsx)(l.O.Provider,{value:g,children:t})};function h(){return new Map}var m=n(49637);let f=e=>e.key||"";function x(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}var p=n(11534);let g=e=>{let{children:t,custom:n,initial:l=!0,onExitComplete:c,presenceAffectsLayout:o=!0,mode:u="sync",propagate:h=!1}=e,[g,y]=(0,m.oO)(h),v=(0,a.useMemo)(()=>x(t),[t]),b=h&&!g?[]:v.map(f),j=(0,a.useRef)(!0),w=(0,a.useRef)(v),N=(0,r.h)(()=>new Map),[k,E]=(0,a.useState)(v),[C,M]=(0,a.useState)(v);(0,p.L)(()=>{j.current=!1,w.current=v;for(let e=0;e<C.length;e++){let t=f(C[e]);b.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[C,b.length,b.join("-")]);let P=[];if(v!==k){let e=[...v];for(let t=0;t<C.length;t++){let n=C[t],s=f(n);b.includes(s)||(e.splice(t,0,n),P.push(n))}"wait"===u&&P.length&&(e=P),M(x(e)),E(v);return}let{forceRender:A}=(0,a.useContext)(i.p);return(0,s.jsx)(s.Fragment,{children:C.map(e=>{let t=f(e),a=(!h||!!g)&&(v===C||b.includes(t));return(0,s.jsx)(d,{isPresent:a,initial:(!j.current||!!l)&&void 0,custom:a?void 0:n,presenceAffectsLayout:o,mode:u,onExitComplete:a?void 0:()=>{if(!N.has(t))return;N.set(t,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==A||A(),M(w.current),h&&(null==y||y()),c&&c())},children:e},t)})})}}},function(e){e.O(0,[6137,7230,4875,4270,2971,2117,1744],function(){return e(e.s=91826)}),_N_E=e.O()}]);