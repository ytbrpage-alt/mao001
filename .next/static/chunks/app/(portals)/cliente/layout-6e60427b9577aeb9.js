(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7313],{61501:function(e,t,n){Promise.resolve().then(n.bind(n,97541))},97541:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var a=n(57437),s=n(14362),i=n(27648),r=n(99637),l=n(92369),c=n(31047),o=n(95805),d=n(48736),u=n(82718),x=n(88226),f=n(98728),h=n(70112),m=n(99376),b=n(40521),p=n(91001);function g(e){let{href:t,icon:n,label:s,badge:r,collapsed:l=!1,onClick:c}=e,o=(0,m.usePathname)(),d=o===t||o.startsWith("".concat(t,"/"));return(0,a.jsxs)(i.default,{href:t,onClick:c,className:(0,p.cn)("flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200","hover:bg-neutral-100",d&&"bg-brand-50 text-brand-600 font-medium",!d&&"text-neutral-600",l&&"justify-center px-2"),children:[(0,a.jsx)("span",{className:(0,p.cn)("flex-shrink-0 w-5 h-5",d&&"text-brand-500"),children:n}),!l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"flex-1 truncate",children:s}),void 0!==r&&r>0&&(0,a.jsx)(b.E.span,{initial:{scale:0},animate:{scale:1},className:(0,p.cn)("flex-shrink-0 min-w-5 h-5 px-1.5 rounded-full text-xs font-medium","flex items-center justify-center",d?"bg-brand-500 text-white":"bg-neutral-200 text-neutral-600"),children:r>99?"99+":r})]}),l&&(0,a.jsxs)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-neutral-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap z-50",children:[s,void 0!==r&&r>0&&" (".concat(r,")")]})]})}var j=n(99667);let v=[{href:"/cliente",icon:r.Z,label:"In\xedcio"},{href:"/cliente/paciente",icon:l.Z,label:"Paciente"},{href:"/cliente/agenda",icon:c.Z,label:"Agenda"},{href:"/cliente/profissionais",icon:o.Z,label:"Profissionais"},{href:"/cliente/documentos",icon:d.Z,label:"Documentos"},{href:"/cliente/mensagens",icon:u.Z,label:"Mensagens"},{href:"/cliente/financeiro",icon:x.Z,label:"Financeiro"}],N=[{href:"/cliente/configuracoes",icon:f.Z,label:"Configura\xe7\xf5es"},{href:"/cliente/ajuda",icon:h.Z,label:"Ajuda"}];function w(){let{unreadCount:e}=(0,j.G)();return(0,a.jsxs)("nav",{className:"h-full flex flex-col p-4",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)(i.default,{href:"/cliente",className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD1D"}),(0,a.jsx)("span",{className:"font-bold text-lg text-neutral-900",children:"M\xe3os Amigas"})]})}),(0,a.jsx)("div",{className:"flex-1 space-y-1",children:v.map(t=>(0,a.jsx)(g,{href:t.href,icon:(0,a.jsx)(t.icon,{className:"w-5 h-5"}),label:t.label,badge:"/cliente/mensagens"===t.href?e:void 0},t.href))}),(0,a.jsx)("div",{className:"my-4 border-t border-neutral-200"}),(0,a.jsx)("div",{className:"space-y-1",children:N.map(e=>(0,a.jsx)(g,{href:e.href,icon:(0,a.jsx)(e.icon,{className:"w-5 h-5"}),label:e.label},e.href))})]})}var y=n(2265),C=n(58293),A=n(73247),k=n(32489),E=n(48614),D=n(23469);function Z(){var e;let{user:t,logout:n}=(0,s.aC)(),[r,l]=(0,y.useState)(!1),[c,o]=(0,y.useState)(!1);return(0,a.jsxs)("header",{className:"fixed top-0 left-0 right-0 h-16 bg-white border-b border-neutral-200 z-40",children:[(0,a.jsxs)("div",{className:"h-full px-4 lg:px-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"lg:hidden flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>l(!0),className:"p-2 -ml-2 text-neutral-600",children:(0,a.jsx)(C.Z,{className:"w-6 h-6"})}),(0,a.jsx)(i.default,{href:"/cliente",className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83E\uDD1D"})})]}),(0,a.jsx)("div",{className:"hidden lg:block"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"hidden sm:block relative",children:[(0,a.jsx)(A.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar...",className:"w-64 pl-9 pr-4 py-2 bg-neutral-100 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-brand-500"})]}),(0,a.jsx)(D.L,{}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>o(!c),className:"flex items-center gap-2 p-1 rounded-full hover:bg-neutral-100",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-100 flex items-center justify-center text-brand-600 font-medium text-sm",children:(null==t?void 0:null===(e=t.fullName)||void 0===e?void 0:e.split(" ").map(e=>e[0]).slice(0,2).join(""))||"U"})}),(0,a.jsx)(E.M,{children:c&&(0,a.jsxs)(b.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-strong border border-neutral-200 py-1",children:[(0,a.jsxs)("div",{className:"px-3 py-2 border-b border-neutral-100",children:[(0,a.jsx)("p",{className:"font-medium text-sm text-neutral-900 truncate",children:null==t?void 0:t.fullName}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 truncate",children:null==t?void 0:t.email})]}),(0,a.jsx)(i.default,{href:"/cliente/configuracoes",className:"block px-3 py-2 text-sm text-neutral-700 hover:bg-neutral-50",children:"Configura\xe7\xf5es"}),(0,a.jsx)("button",{onClick:n,className:"w-full text-left px-3 py-2 text-sm text-danger-600 hover:bg-danger-50",children:"Sair"})]})})]})]})]}),(0,a.jsx)(E.M,{children:r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>l(!1)}),(0,a.jsx)(b.E.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"tween"},className:"fixed left-0 top-0 bottom-0 w-72 bg-white z-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-neutral-200",children:[(0,a.jsxs)(i.default,{href:"/cliente",className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83E\uDD1D"}),(0,a.jsx)("span",{className:"font-bold",children:"M\xe3os Amigas"})]}),(0,a.jsx)("button",{onClick:()=>l(!1),className:"p-2 text-neutral-600",children:(0,a.jsx)(k.Z,{className:"w-5 h-5"})})]})})]})})]})}let P=[{href:"/cliente",icon:r.Z,label:"In\xedcio"},{href:"/cliente/paciente",icon:l.Z,label:"Paciente"},{href:"/cliente/agenda",icon:c.Z,label:"Agenda"},{href:"/cliente/mensagens",icon:u.Z,label:"Mensagens"},{href:"/cliente/mais",icon:C.Z,label:"Mais"}];function M(){let e=(0,m.usePathname)();return(0,a.jsx)("nav",{className:"bg-white border-t border-neutral-200 pb-safe-bottom",children:(0,a.jsx)("div",{className:"flex items-center justify-around py-2",children:P.map(t=>{let n=e===t.href||"/cliente"!==t.href&&e.startsWith(t.href);return(0,a.jsxs)(i.default,{href:t.href,className:(0,p.cn)("flex flex-col items-center gap-1 px-3 py-1.5 rounded-lg transition-colors min-w-[64px]",n?"text-brand-600":"text-neutral-500 hover:text-neutral-700"),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(t.icon,{className:(0,p.cn)("w-6 h-6",n&&"text-brand-500")}),n&&(0,a.jsx)(b.E.div,{layoutId:"bottomNavIndicator",className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-brand-500 rounded-full"})]}),(0,a.jsx)("span",{className:(0,p.cn)("text-xs",n&&"font-medium"),children:t.label})]},t.href)})})})}function S(e){let{children:t}=e,{user:n,isLoading:i}=(0,s.aC)();return i?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"})}):(null==n?void 0:n.role)!=="client"&&(null==n?void 0:n.role)!=="admin"?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50",children:(0,a.jsx)("p",{className:"text-neutral-500",children:"Acesso n\xe3o autorizado"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-neutral-50",children:[(0,a.jsx)(Z,{}),(0,a.jsx)("div",{className:"hidden lg:block fixed left-0 top-16 bottom-0 w-64 bg-white border-r border-neutral-200",children:(0,a.jsx)(w,{})}),(0,a.jsx)("main",{className:"lg:ml-64 pt-16 pb-20 lg:pb-6 min-h-screen",children:(0,a.jsx)("div",{className:"container-mobile lg:max-w-5xl lg:px-8 py-6",children:t})}),(0,a.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0",children:(0,a.jsx)(M,{})})]})}},23469:function(e,t,n){"use strict";n.d(t,{L:function(){return h}});var a=n(57437),s=n(2265),i=n(40521),r=n(48614),l=n(94766),c=n(59196),o=n(32489),d=n(78442),u=n(34862),x=n(99667),f=n(91001);function h(){let[e,t]=(0,s.useState)(!1),n=(0,s.useRef)(null),{notifications:h,unreadCount:m,markAsRead:b,markAllAsRead:p,deleteNotification:g}=(0,x.G)();(0,s.useEffect)(()=>{let a=e=>{n.current&&!n.current.contains(e.target)&&t(!1)};return e&&document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[e]);let j=h.slice(0,10),v=e=>{switch(e){case"urgent":return"border-l-danger-500";case"high":return"border-l-warning-500";case"medium":return"border-l-brand-500";default:return"border-l-neutral-300"}};return(0,a.jsxs)("div",{className:"relative",ref:n,children:[(0,a.jsxs)("button",{onClick:()=>t(!e),className:"relative p-2 rounded-full hover:bg-neutral-100 transition-colors","aria-label":"Notifica\xe7\xf5es".concat(m>0?" (".concat(m," n\xe3o lidas)"):""),children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-neutral-600"}),m>0&&(0,a.jsx)(i.E.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-danger-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:m>9?"9+":m})]}),(0,a.jsx)(r.M,{children:e&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute right-0 top-full mt-2 w-80 sm:w-96 bg-white rounded-xl shadow-strong border border-neutral-200 overflow-hidden z-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-100",children:[(0,a.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Notifica\xe7\xf5es"}),m>0&&(0,a.jsxs)("button",{onClick:p,className:"flex items-center gap-1 text-xs text-brand-600 hover:text-brand-700",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4"}),"Marcar todas como lidas"]})]}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===j.length?(0,a.jsxs)("div",{className:"py-12 text-center",children:[(0,a.jsx)(l.Z,{className:"w-10 h-10 text-neutral-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-neutral-500",children:"Nenhuma notifica\xe7\xe3o"})]}):(0,a.jsx)("div",{className:"divide-y divide-neutral-100",children:j.map(e=>(0,a.jsx)(i.E.div,{layout:!0,className:(0,f.cn)("px-4 py-3 hover:bg-neutral-50 transition-colors cursor-pointer","border-l-4",v(e.priority),!e.read&&"bg-brand-50/30"),onClick:()=>{b(e.id),e.actionUrl&&(window.location.href=e.actionUrl)},children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:(0,f.cn)("text-sm",!e.read&&"font-medium"),children:e.title}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5 line-clamp-2",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:(0,d.Q)(new Date(e.createdAt),{locale:u.F,addSuffix:!0})})]}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),g(e.id)},className:"p-1 text-neutral-400 hover:text-neutral-600 rounded",children:(0,a.jsx)(o.Z,{className:"w-4 h-4"})})]})},e.id))})}),h.length>10&&(0,a.jsx)("div",{className:"px-4 py-2 border-t border-neutral-100 text-center",children:(0,a.jsx)("a",{href:"/notificacoes",className:"text-sm text-brand-600 hover:text-brand-700",children:"Ver todas as notifica\xe7\xf5es"})})]})})]})}},14362:function(e,t,n){"use strict";n.d(t,{Ho:function(){return o},QL:function(){return u},aC:function(){return d}});var a=n(57437),s=n(2265),i=n(99376),r=n(64270);let l=(0,s.createContext)(null),c=["/login","/forgot-pin","/"];function o(e){let{children:t}=e,n=(0,i.useRouter)(),o=(0,i.usePathname)(),d=function(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{t(!0)},[]),e}(),u=(0,r.t)(),[x,f]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),[b,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(!d)return;let e=setTimeout(()=>{(0,r.v)().then(()=>{p(!0)})},100);return()=>clearTimeout(e)},[d]),(0,s.useEffect)(()=>{if(!b)return;let e=()=>{if(!u.checkSession()&&!c.includes(o)){n.push("/login");return}if(u.session){let e=new Date(u.session.expiresAt).getTime()-Date.now();m(e),f(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[b,o,n,u]),(0,s.useEffect)(()=>{if(!u.isAuthenticated)return;let e=()=>{u.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[u.isAuthenticated,u]),(0,s.useEffect)(()=>{if(!b)return;let e=c.includes(o);u.isAuthenticated||e?u.isAuthenticated&&"/login"===o&&n.push("/"):n.push("/login")},[b,u.isAuthenticated,o,n]);let g=(0,s.useCallback)(async e=>{let t=await u.loginWithPin(e);return t.success&&n.push("/"),t},[u,n]),j=(0,s.useCallback)(()=>{u.logout(),n.push("/login")},[u,n]),v=(0,s.useCallback)(()=>{u.refreshSession(),f(!1)},[u]),N=(0,s.useCallback)(e=>u.hasPermission(e),[u]),w={user:u.getCurrentUser(),isAuthenticated:u.isAuthenticated,isLoading:!b,permissions:u.getPermissions(),login:g,logout:j,hasPermission:N,showSessionWarning:x,sessionExpiresIn:h,extendSession:v};return(0,a.jsx)(l.Provider,{value:w,children:t})}function d(){let e=(0,s.useContext)(l);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function u(e){let{isAuthenticated:t,isLoading:n,hasPermission:a}=d(),r=(0,i.useRouter)();return(0,s.useEffect)(()=>{if(!n){if(!t){r.push("/login");return}e&&!a(e)&&r.push("/unauthorized")}},[t,n,e,a,r]),{isLoading:n,isAuthorized:t&&(!e||a(e))}}},91001:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var a=n(61994),s=n(53335);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,a.W)(t))}},99667:function(e,t,n){"use strict";n.d(t,{G:function(){return r}});var a=n(59625),s=n(89134),i=n(49360);let r=(0,a.Ue)()((0,s.tJ)((e,t)=>({notifications:[],unreadCount:0,addNotification:t=>{let n=(0,i.Z)(),a=new Date,s={...t,id:n,createdAt:a,read:!1,deliveredVia:["in_app"]};return e(e=>({notifications:[s,...e.notifications].slice(0,100),unreadCount:e.unreadCount+1})),n},markAsRead:t=>{e(e=>{let n=e.notifications.find(e=>e.id===t);return!n||n.read?e:{notifications:e.notifications.map(e=>e.id===t?{...e,read:!0,readAt:new Date}:e),unreadCount:Math.max(0,e.unreadCount-1)}})},markAllAsRead:()=>{let t=new Date;e(e=>({notifications:e.notifications.map(e=>e.read?e:{...e,read:!0,readAt:t}),unreadCount:0}))},deleteNotification:t=>{e(e=>{let n=e.notifications.find(e=>e.id===t);return{notifications:e.notifications.filter(e=>e.id!==t),unreadCount:n&&!n.read?Math.max(0,e.unreadCount-1):e.unreadCount}})},clearAll:()=>{e({notifications:[],unreadCount:0})},getNotificationsByType:e=>t().notifications.filter(t=>t.type===e),getUnreadNotifications:()=>t().notifications.filter(e=>!e.read),getNotificationsByPriority:e=>t().notifications.filter(t=>t.priority===e),removeExpired:()=>{let n=new Date,{notifications:a}=t(),s=a.filter(e=>!e.expiresAt||new Date(e.expiresAt)>n),i=a.length-s.length;if(i>0){let t=a.filter(e=>e.expiresAt&&new Date(e.expiresAt)<=n&&!e.read).length;e(e=>({notifications:s,unreadCount:Math.max(0,e.unreadCount-t)}))}return i}}),{name:"maos-amigas-notifications",storage:(0,s.FL)(()=>localStorage)}))}},function(e){e.O(0,[6137,7230,4875,2859,2972,1013,1667,4270,2971,2117,1744],function(){return e(e.s=61501)}),_N_E=e.O()}]);