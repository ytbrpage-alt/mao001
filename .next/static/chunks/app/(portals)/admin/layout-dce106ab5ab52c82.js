(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1518],{46742:function(e,t,n){Promise.resolve().then(n.bind(n,37462))},99376:function(e,t,n){"use strict";var r=n(35475);n.o(r,"useParams")&&n.d(t,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},37462:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var r=n(57437),s=n(2265),u=n(14362),i=n(91001);function a(e){let{children:t}=e,{user:n,isLoading:a}=(0,u.aC)(),[c,o]=(0,s.useState)(!1);return a?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-neutral-100",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"})}):["admin","supervisor","evaluator"].includes((null==n?void 0:n.role)||"")?(0,r.jsx)("div",{className:"min-h-screen bg-neutral-100",children:(0,r.jsx)("div",{className:(0,i.cn)("transition-all duration-300",c?"lg:ml-20":"lg:ml-64"),children:(0,r.jsx)("main",{className:"pt-16 min-h-screen",children:(0,r.jsx)("div",{className:"p-4 lg:p-6",children:t})})})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-neutral-100",children:(0,r.jsx)("p",{className:"text-neutral-500",children:"Acesso n\xe3o autorizado"})})}},14362:function(e,t,n){"use strict";n.d(t,{Ho:function(){return o},QL:function(){return d},aC:function(){return l}});var r=n(57437),s=n(2265),u=n(99376),i=n(64270);let a=(0,s.createContext)(null),c=["/login","/forgot-pin","/"];function o(e){let{children:t}=e,n=(0,u.useRouter)(),o=(0,u.usePathname)(),l=function(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{t(!0)},[]),e}(),d=(0,i.t)(),[f,h]=(0,s.useState)(!1),[m,v]=(0,s.useState)(null),[g,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(!l)return;let e=setTimeout(()=>{(0,i.v)().then(()=>{p(!0)})},100);return()=>clearTimeout(e)},[l]),(0,s.useEffect)(()=>{if(!g)return;let e=()=>{if(!d.checkSession()&&!c.includes(o)){n.push("/login");return}if(d.session){let e=new Date(d.session.expiresAt).getTime()-Date.now();v(e),h(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[g,o,n,d]),(0,s.useEffect)(()=>{if(!d.isAuthenticated)return;let e=()=>{d.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[d.isAuthenticated,d]),(0,s.useEffect)(()=>{if(!g)return;let e=c.includes(o);d.isAuthenticated||e?d.isAuthenticated&&"/login"===o&&n.push("/"):n.push("/login")},[g,d.isAuthenticated,o,n]);let P=(0,s.useCallback)(async e=>{let t=await d.loginWithPin(e);return t.success&&n.push("/"),t},[d,n]),x=(0,s.useCallback)(()=>{d.logout(),n.push("/login")},[d,n]),b=(0,s.useCallback)(()=>{d.refreshSession(),h(!1)},[d]),A=(0,s.useCallback)(e=>d.hasPermission(e),[d]),E={user:d.getCurrentUser(),isAuthenticated:d.isAuthenticated,isLoading:!g,permissions:d.getPermissions(),login:P,logout:x,hasPermission:A,showSessionWarning:f,sessionExpiresIn:m,extendSession:b};return(0,r.jsx)(a.Provider,{value:E,children:t})}function l(){let e=(0,s.useContext)(a);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function d(e){let{isAuthenticated:t,isLoading:n,hasPermission:r}=l(),i=(0,u.useRouter)();return(0,s.useEffect)(()=>{if(!n){if(!t){i.push("/login");return}e&&!r(e)&&i.push("/unauthorized")}},[t,n,e,r,i]),{isLoading:n,isAuthorized:t&&(!e||r(e))}}},91001:function(e,t,n){"use strict";n.d(t,{cn:function(){return u}});var r=n(61994),s=n(53335);function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[6137,4875,4270,2971,2117,1744],function(){return e(e.s=46742)}),_N_E=e.O()}]);