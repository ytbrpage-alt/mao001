(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5814],{6651:function(e,t,n){Promise.resolve().then(n.bind(n,9291))},9291:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r=n(7437),a=n(4362),s=n(7648),i=n(3469),o=n(2265),c=n(8614),l=n(521),d=n(6372),u=n(5863),m=n(3639),f=n(2489),h=n(1341),x=n(401),g=n(7168),p=n(8442),b=n(4862),v=n(9625),y=n(6885),w=n(9360);let j={baseUrl:n(257).env.NEXT_PUBLIC_API_URL||"https://api.maosamigas.com.br",timeout:3e4,retryAttempts:3,retryDelay:1e3};function N(e){let t={"Content-Type":"application/json","X-Client-Version":"1.0.0","X-Device-Id":localStorage.getItem("maos-amigas-device-id")||""};return e&&(t.Authorization="Bearer ".concat(e)),t}async function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j.retryAttempts;try{let r=new AbortController,a=setTimeout(()=>r.abort(),j.timeout),s=await fetch(e,{...t,signal:r.signal});if(clearTimeout(a),!s.ok&&n>0&&s.status>=500)return await new Promise(e=>setTimeout(e,j.retryDelay)),C(e,t,n-1);return s}catch(r){if(n>0&&r instanceof Error&&"AbortError"!==r.name)return await new Promise(e=>setTimeout(e,j.retryDelay)),C(e,t,n-1);throw r}}let E={async getEvaluations(e,t){try{let n=new URLSearchParams;t&&n.set("since",t.toISOString());let r=await C("".concat(j.baseUrl,"/evaluations?").concat(n),{method:"GET",headers:N(e)}),a=await r.json();return{success:!0,data:a.evaluations,meta:a.meta}}catch(e){return{success:!1,error:{code:"NETWORK_ERROR",message:"Erro de conex\xe3o"}}}},async createEvaluation(e,t){try{let n=await C("".concat(j.baseUrl,"/evaluations"),{method:"POST",headers:N(e),body:JSON.stringify(t)}),r=await n.json();if(!n.ok)return{success:!1,error:r.error};return{success:!0,data:r.evaluation,meta:r.meta}}catch(e){return{success:!1,error:{code:"NETWORK_ERROR",message:"Erro de conex\xe3o"}}}},async updateEvaluation(e,t,n,r){try{let a=N(e);void 0!==r&&(a["If-Match"]='"'.concat(r,'"'));let s=await C("".concat(j.baseUrl,"/evaluations/").concat(t),{method:"PATCH",headers:a,body:JSON.stringify(n)}),i=await s.json();if(409===s.status)return{success:!1,error:{code:"CONFLICT",message:"Conflito de vers\xe3o"},data:i.serverData};if(!s.ok)return{success:!1,error:i.error};return{success:!0,data:i.evaluation,meta:i.meta}}catch(e){return{success:!1,error:{code:"NETWORK_ERROR",message:"Erro de conex\xe3o"}}}},async deleteEvaluation(e,t){try{let n=await C("".concat(j.baseUrl,"/evaluations/").concat(t),{method:"DELETE",headers:N(e)});if(!n.ok){let e=await n.json();return{success:!1,error:e.error}}return{success:!0}}catch(e){return{success:!1,error:{code:"NETWORK_ERROR",message:"Erro de conex\xe3o"}}}},async pushAuditLogs(e,t){try{let n=await C("".concat(j.baseUrl,"/audit-logs/batch"),{method:"POST",headers:N(e),body:JSON.stringify({logs:t})}),r=await n.json();return{success:!0,data:r.savedIds}}catch(e){return{success:!1,error:{code:"NETWORK_ERROR",message:"Erro de conex\xe3o"}}}},async healthCheck(){try{return(await fetch("".concat(j.baseUrl,"/health"),{method:"GET",headers:{"Content-Type":"application/json"}})).ok}catch(e){return!1}}};var S=n(4270),A=n(5859),k=n(1098);let D=(0,v.Ue)()((0,y.tJ)((e,t)=>({lastSyncAt:null,isSyncing:!1,pendingCount:0,conflictCount:0,errorCount:0,progress:0,config:{autoSync:!0,syncIntervalMinutes:5,syncOnReconnect:!0,maxRetries:3,compressData:!0,syncAuditLogs:!0},operationQueue:[],conflicts:[],updateConfig:t=>{e(e=>({config:{...e.config,...t}}))},queueOperation:t=>{let n={...t,id:(0,w.Z)(),timestamp:new Date,retryCount:0};e(e=>({operationQueue:[...e.operationQueue,n],pendingCount:e.pendingCount+1}))},removeOperation:t=>{e(e=>({operationQueue:e.operationQueue.filter(e=>e.id!==t),pendingCount:Math.max(0,e.pendingCount-1)}))},sync:async()=>{let{isSyncing:n,config:r}=t();if(n)return{success:!1,pushed:0,pulled:0,conflicts:[],errors:[{entityId:"",error:"J\xe1 sincronizando"}],duration:0};let a=Date.now();e({isSyncing:!0,progress:0});try{var s;if(!await t().checkConnectivity())return e({isSyncing:!1}),{success:!1,pushed:0,pulled:0,conflicts:[],errors:[{entityId:"",error:"Sem conex\xe3o"}],duration:Date.now()-a};e({progress:20});let n=S.t.getState(),i=A.q.getState(),o=null===(s=n.session)||void 0===s?void 0:s.token;if(!o)return e({isSyncing:!1}),{success:!1,pushed:0,pulled:0,conflicts:[],errors:[{entityId:"",error:"N\xe3o autenticado"}],duration:Date.now()-a};let{operationQueue:c}=t(),l=0;for(let e of c)"evaluation"===e.entityType&&"update"===e.type&&(await E.updateEvaluation(o,e.entityId,e.data)).success&&(t().removeOperation(e.id),l++);e({progress:60});let{lastSyncAt:d}=t(),u=await E.getEvaluations(o,d||void 0),m=0;if(u.success&&u.data)for(let e of u.data){let t=i.getEvaluationById(e.id);(!t||new Date(e.updatedAt)>new Date(t.updatedAt))&&(i.updateEvaluation(e.id,e),m++)}if(e({progress:90}),r.syncAuditLogs){let e=k.k.getState(),t=e.getUnsyncedEntries();if(t.length>0){let n=await E.pushAuditLogs(o,t);n.success&&n.data&&e.markAsSynced(n.data)}}return e({isSyncing:!1,progress:100,lastSyncAt:new Date}),{success:!0,pushed:l,pulled:m,conflicts:[],errors:[],duration:Date.now()-a}}catch(t){return e({isSyncing:!1,progress:0}),{success:!1,pushed:0,pulled:0,conflicts:[],errors:[{entityId:"",error:String(t)}],duration:Date.now()-a}}},resolveConflict:async(n,r,a)=>{let s;let i=t().conflicts.find(e=>e.id===n);if(!i)return;let o=A.q.getState();switch(r){case"local":s=i.localData;break;case"remote":s=i.remoteData;break;case"merged":s=a||{...i.remoteData,...i.localData}}o.updateEvaluation(i.entityId,s),e(e=>({conflicts:e.conflicts.map(e=>e.id===n?{...e,resolvedAt:new Date,resolution:r}:e),conflictCount:Math.max(0,e.conflictCount-1)}))},checkConnectivity:async()=>("undefined"==typeof navigator||!!navigator.onLine)&&E.healthCheck(),retryOperation:t=>{e(e=>({operationQueue:e.operationQueue.map(e=>e.id===t?{...e,retryCount:e.retryCount+1,lastError:void 0}:e)}))},getEntitySyncStatus:e=>{let{operationQueue:n,conflicts:r}=t(),a=n.some(t=>t.entityId===e);return r.some(t=>t.entityId===e&&!t.resolvedAt)?"conflict":a?"pending":"synced"}}),{name:"maos-amigas-sync",storage:(0,y.FL)(()=>localStorage),partialize:e=>({lastSyncAt:e.lastSyncAt,operationQueue:e.operationQueue,conflicts:e.conflicts,config:e.config})}));var O=n(6108),R=n(1001);function T(e){let{minimal:t=!1}=e,{lastSyncAt:n,isSyncing:a,pendingCount:s,conflictCount:i,errorCount:v,progress:y,sync:w}=D(),{isOnline:j}=(0,O.j)(),[N,C]=(0,o.useState)(!1),E=j?a?{icon:u.Z,color:"text-brand-500",bg:"bg-brand-50",label:"Sincronizando...",animate:!0}:i>0?{icon:m.Z,color:"text-warning-500",bg:"bg-warning-50",label:"".concat(i," conflito(s)")}:v>0?{icon:f.Z,color:"text-danger-500",bg:"bg-danger-50",label:"".concat(v," erro(s)")}:s>0?{icon:h.Z,color:"text-brand-500",bg:"bg-brand-50",label:"".concat(s," pendente(s)")}:{icon:x.Z,color:"text-success-500",bg:"bg-success-50",label:"Sincronizado"}:{icon:d.Z,color:"text-neutral-400",bg:"bg-neutral-100",label:"Offline"},S=E.icon,A=async()=>{!a&&j&&await w()};return t?(0,r.jsx)("button",{onClick:A,disabled:a||!j,className:(0,R.cn)("p-2 rounded-full transition-colors",E.bg,E.color),title:E.label,children:(0,r.jsx)(S,{className:(0,R.cn)("w-5 h-5",E.animate&&"animate-spin")})}):(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>C(!N),className:(0,R.cn)("flex items-center gap-2 px-3 py-2 rounded-lg transition-colors",E.bg,E.color),children:[(0,r.jsx)(S,{className:(0,R.cn)("w-4 h-4",E.animate&&"animate-spin")}),(0,r.jsx)("span",{className:"text-sm font-medium",children:E.label})]}),(0,r.jsx)(c.M,{children:N&&(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"absolute right-0 top-full mt-2 w-72 bg-white rounded-xl shadow-strong border border-neutral-200 p-4 z-50",children:[(0,r.jsx)("h3",{className:"font-medium text-neutral-900 mb-3",children:"Status de Sincroniza\xe7\xe3o"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-neutral-500",children:"Conex\xe3o"}),(0,r.jsx)("span",{className:(0,R.cn)("flex items-center gap-1",j?"text-success-600":"text-neutral-400"),children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{className:"w-4 h-4"})," Online"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"w-4 h-4"})," Offline"]})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-neutral-500",children:"\xdaltima sync"}),(0,r.jsx)("span",{className:"text-neutral-700",children:n?(0,p.Q)(new Date(n),{locale:b.F,addSuffix:!0}):"Nunca"})]}),s>0&&(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-neutral-500",children:"Pendentes"}),(0,r.jsx)("span",{className:"text-brand-600 font-medium",children:s})]}),a&&(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("div",{className:"h-1.5 bg-neutral-100 rounded-full overflow-hidden",children:(0,r.jsx)(l.E.div,{className:"h-full bg-brand-500",initial:{width:0},animate:{width:"".concat(y,"%")}})})}),(0,r.jsx)("button",{onClick:A,disabled:a||!j,className:"w-full mt-2 btn-primary text-sm",children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Sincronizando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"Sincronizar agora"]})})]})]})})]})}function L(){let{user:e}=(0,a.aC)();return(0,r.jsx)("header",{className:"fixed top-0 left-0 right-0 h-16 z-40 transition-colors duration-200",style:{backgroundColor:"rgb(var(--color-bg-elevated))",borderBottom:"1px solid rgb(var(--color-border))"},children:(0,r.jsxs)("div",{className:"h-full px-4 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsxs)(s.default,{href:"/pro",className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xl",children:"\uD83E\uDD1D"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-sm leading-tight",style:{color:"rgb(var(--color-text))"},children:"M\xe3os Amigas"}),(0,r.jsx)("p",{className:"text-xs text-brand-500",children:(()=>{switch(null==e?void 0:e.role){case"caregiver":return"Cuidador(a)";case"nurse":return"Enfermeiro(a)";case"nurse_tech":return"T\xe9c. Enfermagem";default:return"Profissional"}})()})]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T,{minimal:!0}),(0,r.jsx)(i.L,{})]})]})})}var P=n(9376),I=n(5832),Z=n(1047),_=n(5805),U=n(8736),z=n(2369);function Q(){let e=(0,P.usePathname)(),{user:t}=(0,a.aC)(),n=(()=>{switch(null==t?void 0:t.role){case"admin":case"caregiver":return"/pro/cuidador";case"nurse":return"/pro/enfermeiro";case"nurse_tech":return"/pro/tecnico";default:return"/pro"}})(),i=[{href:n,icon:I.Z,label:"In\xedcio"},{href:"".concat(n,"/agenda"),icon:Z.Z,label:"Agenda"},{href:"".concat(n,"/pacientes"),icon:_.Z,label:"Pacientes"},{href:"".concat(n,"/evolucoes"),icon:U.Z,label:"Evolu\xe7\xf5es"},{href:"".concat(n,"/perfil"),icon:z.Z,label:"Perfil"}];return(0,r.jsx)("nav",{className:"pb-safe-bottom transition-colors duration-200",style:{backgroundColor:"rgb(var(--color-bg-elevated))",borderTop:"1px solid rgb(var(--color-border))"},children:(0,r.jsx)("div",{className:"flex items-center justify-around py-2",children:i.map(t=>{let n=e===t.href;return(0,r.jsxs)(s.default,{href:t.href,className:(0,R.cn)("flex flex-col items-center gap-1 px-3 py-1.5 rounded-lg transition-all duration-200 min-w-[60px]",n?"text-brand-500":""),style:{color:n?void 0:"rgb(var(--color-text-tertiary))",backgroundColor:n?"rgba(30, 138, 173, 0.1)":"transparent"},children:[(0,r.jsx)(t.icon,{className:(0,R.cn)("w-6 h-6 transition-colors",n&&"text-brand-500")}),(0,r.jsx)("span",{className:(0,R.cn)("text-xs transition-colors",n&&"font-medium"),children:t.label})]},t.href)})})})}let M=["admin","caregiver","nurse","nurse_tech","physiotherapist","nutritionist","psychologist","speech_therapist","occupational_therapist","physician"];function F(e){let{children:t}=e,{user:n,isLoading:s}=(0,a.aC)();return s?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"rgb(var(--color-bg))"},children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"})}):M.includes((null==n?void 0:n.role)||"")?(0,r.jsxs)("div",{className:"min-h-screen",style:{backgroundColor:"rgb(var(--color-bg))"},children:[(0,r.jsx)(L,{}),(0,r.jsx)("main",{className:"pt-16 pb-20 min-h-screen",children:(0,r.jsx)("div",{className:"container-mobile py-4",children:t})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:(0,r.jsx)(Q,{})})]}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"rgb(var(--color-bg))"},children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"mb-4",style:{color:"rgb(var(--color-text-secondary))"},children:"Acesso n\xe3o autorizado"}),(0,r.jsx)("a",{href:"/login",className:"text-brand-500 hover:text-brand-400 hover:underline",children:"Fazer login"})]})})}},3469:function(e,t,n){"use strict";n.d(t,{L:function(){return h}});var r=n(7437),a=n(2265),s=n(521),i=n(8614),o=n(4766),c=n(9196),l=n(2489),d=n(8442),u=n(4862),m=n(9667),f=n(1001);function h(){let[e,t]=(0,a.useState)(!1),n=(0,a.useRef)(null),{notifications:h,unreadCount:x,markAsRead:g,markAllAsRead:p,deleteNotification:b}=(0,m.G)();(0,a.useEffect)(()=>{let r=e=>{n.current&&!n.current.contains(e.target)&&t(!1)};return e&&document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[e]);let v=h.slice(0,10),y=e=>{switch(e){case"urgent":return"border-l-danger-500";case"high":return"border-l-warning-500";case"medium":return"border-l-brand-500";default:return"border-l-neutral-300"}};return(0,r.jsxs)("div",{className:"relative",ref:n,children:[(0,r.jsxs)("button",{onClick:()=>t(!e),className:"relative p-2 rounded-full hover:bg-neutral-100 transition-colors","aria-label":"Notifica\xe7\xf5es".concat(x>0?" (".concat(x," n\xe3o lidas)"):""),children:[(0,r.jsx)(o.Z,{className:"w-5 h-5 text-neutral-600"}),x>0&&(0,r.jsx)(s.E.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-danger-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:x>9?"9+":x})]}),(0,r.jsx)(i.M,{children:e&&(0,r.jsxs)(s.E.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute right-0 top-full mt-2 w-80 sm:w-96 bg-white rounded-xl shadow-strong border border-neutral-200 overflow-hidden z-50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-100",children:[(0,r.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Notifica\xe7\xf5es"}),x>0&&(0,r.jsxs)("button",{onClick:p,className:"flex items-center gap-1 text-xs text-brand-600 hover:text-brand-700",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4"}),"Marcar todas como lidas"]})]}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===v.length?(0,r.jsxs)("div",{className:"py-12 text-center",children:[(0,r.jsx)(o.Z,{className:"w-10 h-10 text-neutral-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-neutral-500",children:"Nenhuma notifica\xe7\xe3o"})]}):(0,r.jsx)("div",{className:"divide-y divide-neutral-100",children:v.map(e=>(0,r.jsx)(s.E.div,{layout:!0,className:(0,f.cn)("px-4 py-3 hover:bg-neutral-50 transition-colors cursor-pointer","border-l-4",y(e.priority),!e.read&&"bg-brand-50/30"),onClick:()=>{g(e.id),e.actionUrl&&(window.location.href=e.actionUrl)},children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:(0,f.cn)("text-sm",!e.read&&"font-medium"),children:e.title}),(0,r.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5 line-clamp-2",children:e.message}),(0,r.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:(0,d.Q)(new Date(e.createdAt),{locale:u.F,addSuffix:!0})})]}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),b(e.id)},className:"p-1 text-neutral-400 hover:text-neutral-600 rounded",children:(0,r.jsx)(l.Z,{className:"w-4 h-4"})})]})},e.id))})}),h.length>10&&(0,r.jsx)("div",{className:"px-4 py-2 border-t border-neutral-100 text-center",children:(0,r.jsx)("a",{href:"/notificacoes",className:"text-sm text-brand-600 hover:text-brand-700",children:"Ver todas as notifica\xe7\xf5es"})})]})})]})}},4362:function(e,t,n){"use strict";n.d(t,{Ho:function(){return l},QL:function(){return u},aC:function(){return d}});var r=n(7437),a=n(2265),s=n(9376),i=n(4270);let o=(0,a.createContext)(null),c=["/login","/forgot-pin","/"];function l(e){let{children:t}=e,n=(0,s.useRouter)(),l=(0,s.usePathname)(),d=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t(!0)},[]),e}(),u=(0,i.t)(),[m,f]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),[g,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!d)return;let e=setTimeout(()=>{(0,i.v)().then(()=>{p(!0)})},100);return()=>clearTimeout(e)},[d]),(0,a.useEffect)(()=>{if(!g)return;let e=()=>{if(!u.checkSession()&&!c.includes(l)){n.push("/login");return}if(u.session){let e=new Date(u.session.expiresAt).getTime()-Date.now();x(e),f(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[g,l,n,u]),(0,a.useEffect)(()=>{if(!u.isAuthenticated)return;let e=()=>{u.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[u.isAuthenticated,u]),(0,a.useEffect)(()=>{if(!g)return;let e=c.includes(l);u.isAuthenticated||e?u.isAuthenticated&&"/login"===l&&n.push("/"):n.push("/login")},[g,u.isAuthenticated,l,n]);let b=(0,a.useCallback)(async e=>{let t=await u.loginWithPin(e);return t.success&&n.push("/"),t},[u,n]),v=(0,a.useCallback)(()=>{u.logout(),n.push("/login")},[u,n]),y=(0,a.useCallback)(()=>{u.refreshSession(),f(!1)},[u]),w=(0,a.useCallback)(e=>u.hasPermission(e),[u]),j={user:u.getCurrentUser(),isAuthenticated:u.isAuthenticated,isLoading:!g,permissions:u.getPermissions(),login:b,logout:v,hasPermission:w,showSessionWarning:m,sessionExpiresIn:h,extendSession:y};return(0,r.jsx)(o.Provider,{value:j,children:t})}function d(){let e=(0,a.useContext)(o);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function u(e){let{isAuthenticated:t,isLoading:n,hasPermission:r}=d(),i=(0,s.useRouter)();return(0,a.useEffect)(()=>{if(!n){if(!t){i.push("/login");return}e&&!r(e)&&i.push("/unauthorized")}},[t,n,e,r,i]),{isLoading:n,isAuthorized:t&&(!e||r(e))}}},6108:function(e,t,n){"use strict";n.d(t,{g:function(){return i},j:function(){return o}});var r=n(7437),a=n(2265);let s=(0,a.createContext)(null);function i(e){let{children:t}=e,[n,i]=(0,a.useState)(!0),[o,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(0),[u,m]=(0,a.useState)(null);(0,a.useEffect)(()=>{i(navigator.onLine);let e=()=>i(!0),t=()=>i(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(()=>{c(!0)}),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);let f=async()=>{m(new Date),d(0)};return(0,r.jsx)(s.Provider,{value:{isOnline:n,isOfflineReady:o,pendingSyncs:l,lastSyncTime:u,forceSync:f},children:t})}function o(){let e=(0,a.useContext)(s);if(!e)throw Error("useOffline deve ser usado dentro de OfflineProvider");return e}},9667:function(e,t,n){"use strict";n.d(t,{G:function(){return i}});var r=n(9625),a=n(6885),s=n(9360);let i=(0,r.Ue)()((0,a.tJ)((e,t)=>({notifications:[],unreadCount:0,addNotification:t=>{let n=(0,s.Z)(),r=new Date,a={...t,id:n,createdAt:r,read:!1,deliveredVia:["in_app"]};return e(e=>({notifications:[a,...e.notifications].slice(0,100),unreadCount:e.unreadCount+1})),n},markAsRead:t=>{e(e=>{let n=e.notifications.find(e=>e.id===t);return!n||n.read?e:{notifications:e.notifications.map(e=>e.id===t?{...e,read:!0,readAt:new Date}:e),unreadCount:Math.max(0,e.unreadCount-1)}})},markAllAsRead:()=>{let t=new Date;e(e=>({notifications:e.notifications.map(e=>e.read?e:{...e,read:!0,readAt:t}),unreadCount:0}))},deleteNotification:t=>{e(e=>{let n=e.notifications.find(e=>e.id===t);return{notifications:e.notifications.filter(e=>e.id!==t),unreadCount:n&&!n.read?Math.max(0,e.unreadCount-1):e.unreadCount}})},clearAll:()=>{e({notifications:[],unreadCount:0})},getNotificationsByType:e=>t().notifications.filter(t=>t.type===e),getUnreadNotifications:()=>t().notifications.filter(e=>!e.read),getNotificationsByPriority:e=>t().notifications.filter(t=>t.priority===e),removeExpired:()=>{let n=new Date,{notifications:r}=t(),a=r.filter(e=>!e.expiresAt||new Date(e.expiresAt)>n),s=r.length-a.length;if(s>0){let t=r.filter(e=>e.expiresAt&&new Date(e.expiresAt)<=n&&!e.read).length;e(e=>({notifications:a,unreadCount:Math.max(0,e.unreadCount-t)}))}return s}}),{name:"maos-amigas-notifications",storage:(0,a.FL)(()=>localStorage)}))}},function(e){e.O(0,[6137,7230,4875,2859,7648,9179,5060,4270,5859,3483,2971,2117,1744],function(){return e(e.s=6651)}),_N_E=e.O()}]);