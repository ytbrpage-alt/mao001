(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{89311:function(e,t,n){Promise.resolve().then(n.bind(n,16117))},65302:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(39763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},10407:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(39763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},43044:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(39763).Z)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]])},91723:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(39763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},99397:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},92369:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(39763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},99376:function(e,t,n){"use strict";var a=n(35475);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})},16117:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var a=n(57437),s=n(99376),i=n(40521),r=n(92369),l=n(99397),c=n(43044),u=n(91723),d=n(65302),o=n(10407),m=n(5859),h=n(89102),f=n(14362);function x(){var e;let t=(0,s.useRouter)(),{user:n}=(0,f.aC)(),{evaluations:x,createEvaluation:p}=(0,m.q)(),g=Object.values(x),N=g.sort((e,t)=>new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime()).slice(0,5),y={total:g.length,pending:g.filter(e=>"in_progress"===e.status||"draft"===e.status).length,completed:g.filter(e=>"completed"===e.status).length},v=e=>{switch(e){case"draft":return(0,a.jsx)("span",{className:"badge-warning",children:"Rascunho"});case"in_progress":return(0,a.jsx)("span",{className:"badge-info",children:"Em Andamento"});case"completed":return(0,a.jsx)("span",{className:"badge-success",children:"Conclu\xedda"});default:return null}};return(0,a.jsxs)("main",{className:"container-mobile min-h-screen pb-24 lg:pb-12",children:[(0,a.jsx)("header",{className:"pt-6 pb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-brand-500 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xl font-bold",children:"MA"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-neutral-900",children:"M\xe3os Amigas"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Sistema de Avalia\xe7\xe3o"})]})]}),(0,a.jsxs)("div",{className:"hidden sm:flex items-center gap-3 bg-white rounded-full pl-4 pr-2 py-2 shadow-soft",children:[(0,a.jsxs)("span",{className:"text-sm text-neutral-600",children:["Ol\xe1, ",(0,a.jsx)("span",{className:"font-medium",suppressHydrationWarning:!0,children:(null==n?void 0:null===(e=n.fullName)||void 0===e?void 0:e.split(" ")[0])||"Avaliador"})]}),(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-100 flex items-center justify-center",children:(0,a.jsx)(r.Z,{className:"w-4 h-4 text-brand-600"})})]})]})}),(0,a.jsxs)("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,a.jsx)("section",{children:(0,a.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{let e=p("evaluator-1");t.push("/avaliacao/".concat(e))},className:"w-full btn-primary gap-3 text-lg py-4",children:[(0,a.jsx)(l.Z,{className:"w-6 h-6"}),"Nova Avalia\xe7\xe3o"]})}),(0,a.jsxs)("section",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"card text-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 bg-brand-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-5 h-5 text-brand-600"})}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:y.total}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Total"})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"card text-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 bg-warning-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-warning-600"})}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:y.pending}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Pendentes"})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"card text-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 bg-success-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-5 h-5 text-success-600"})}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:y.completed}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Conclu\xeddas"})]})]}),(0,a.jsxs)("button",{onClick:()=>t.push("/avaliacao"),className:"hidden lg:flex w-full btn-secondary gap-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5"}),"Ver Todas as Avalia\xe7\xf5es"]})]}),(0,a.jsxs)("section",{className:"lg:col-span-2 mt-8 lg:mt-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-neutral-900",children:"Avalia\xe7\xf5es Recentes"}),(0,a.jsx)("button",{onClick:()=>t.push("/avaliacao"),className:"text-sm text-brand-600 hover:text-brand-700 font-medium lg:hidden",children:"Ver todas"})]}),0===N.length?(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"card text-center py-12 lg:py-16",children:[(0,a.jsx)(c.Z,{className:"w-16 h-16 mx-auto mb-4 text-neutral-300"}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium",children:"Nenhuma avalia\xe7\xe3o ainda"}),(0,a.jsx)("p",{className:"text-sm text-neutral-400 mt-1",children:'Clique em "Nova Avalia\xe7\xe3o" para come\xe7ar'})]}):(0,a.jsx)("div",{className:"space-y-3 lg:grid lg:grid-cols-2 lg:gap-4 lg:space-y-0",children:N.map((e,n)=>(0,a.jsx)(i.E.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*n},whileHover:{scale:1.01},onClick:()=>t.push("/avaliacao/".concat(e.id)),className:"card w-full text-left touch-feedback hover:shadow-medium transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-brand-100 flex items-center justify-center text-brand-600 font-semibold flex-shrink-0",children:(e.patient.preferredName||e.patient.fullName||"P")[0].toUpperCase()}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 truncate",children:e.patient.fullName||"Paciente n\xe3o informado"}),v(e.status)]}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5",children:(0,h.zg)(e.updatedAt)})]}),(0,a.jsx)(o.Z,{className:"w-5 h-5 text-neutral-300 flex-shrink-0 hidden sm:block"})]})},e.id))})]})]})]})}},14362:function(e,t,n){"use strict";n.d(t,{Ho:function(){return u},QL:function(){return o},aC:function(){return d}});var a=n(57437),s=n(2265),i=n(99376),r=n(64270);let l=(0,s.createContext)(null),c=["/login","/forgot-pin","/"];function u(e){let{children:t}=e,n=(0,i.useRouter)(),u=(0,i.usePathname)(),d=function(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{t(!0)},[]),e}(),o=(0,r.t)(),[m,h]=(0,s.useState)(!1),[f,x]=(0,s.useState)(null),[p,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(!d)return;let e=setTimeout(()=>{(0,r.v)().then(()=>{g(!0)})},100);return()=>clearTimeout(e)},[d]),(0,s.useEffect)(()=>{if(!p)return;let e=()=>{if(!o.checkSession()&&!c.includes(u)){n.push("/login");return}if(o.session){let e=new Date(o.session.expiresAt).getTime()-Date.now();x(e),h(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[p,u,n,o]),(0,s.useEffect)(()=>{if(!o.isAuthenticated)return;let e=()=>{o.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[o.isAuthenticated,o]),(0,s.useEffect)(()=>{if(!p)return;let e=c.includes(u);o.isAuthenticated||e?o.isAuthenticated&&"/login"===u&&n.push("/"):n.push("/login")},[p,o.isAuthenticated,u,n]);let N=(0,s.useCallback)(async e=>{let t=await o.loginWithPin(e);return t.success&&n.push("/"),t},[o,n]),y=(0,s.useCallback)(()=>{o.logout(),n.push("/login")},[o,n]),v=(0,s.useCallback)(()=>{o.refreshSession(),h(!1)},[o]),j=(0,s.useCallback)(e=>o.hasPermission(e),[o]),w={user:o.getCurrentUser(),isAuthenticated:o.isAuthenticated,isLoading:!p,permissions:o.getPermissions(),login:N,logout:y,hasPermission:j,showSessionWarning:m,sessionExpiresIn:f,extendSession:v};return(0,a.jsx)(l.Provider,{value:w,children:t})}function d(){let e=(0,s.useContext)(l);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function o(e){let{isAuthenticated:t,isLoading:n,hasPermission:a}=d(),r=(0,i.useRouter)();return(0,s.useEffect)(()=>{if(!n){if(!t){r.push("/login");return}e&&!a(e)&&r.push("/unauthorized")}},[t,n,e,a,r]),{isLoading:n,isAuthorized:t&&(!e||a(e))}}},89102:function(e,t,n){"use strict";n.d(t,{Fw:function(){return u},p6:function(){return l},zg:function(){return c}});var a=n(60936),s=n(84122),i=n(78442),r=n(34862);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd/MM/yyyy",n="string"==typeof e?(0,a.D)(e):e;return(0,s.WU)(n,t,{locale:r.F})}function c(e){let t="string"==typeof e?(0,a.D)(e):e;return(0,i.Q)(t,{locale:r.F,addSuffix:!0})}function u(e){let t=new Date,n=t.getFullYear()-e.getFullYear(),a=t.getMonth()-e.getMonth();return(a<0||0===a&&t.getDate()<e.getDate())&&n--,n}},60936:function(e,t,n){"use strict";n.d(t,{D:function(){return s}});var a=n(78198);function s(e,t){var n;let s,h;let f=null!==(n=null==t?void 0:t.additionalDigits)&&void 0!==n?n:2,x=function(e){let t;let n={},a=e.split(i.dateTimeDelimiter);if(a.length>2)return n;if(/:/.test(a[0])?t=a[0]:(n.date=a[0],t=a[1],i.timeZoneDelimiter.test(n.date)&&(n.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length))),t){let e=i.timezone.exec(t);e?(n.time=t.replace(e[1],""),n.timezone=e[1]):n.time=t}return n}(e);if(x.date){let e=function(e,t){let n=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=e.match(n);if(!a)return{year:NaN,restDateString:""};let s=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:null===i?s:100*i,restDateString:e.slice((a[1]||a[2]).length)}}(x.date,f);s=function(e,t){if(null===t)return new Date(NaN);let n=e.match(r);if(!n)return new Date(NaN);let a=!!n[4],s=u(n[1]),i=u(n[2])-1,l=u(n[3]),c=u(n[4]),d=u(n[5])-1;if(a)return c>=1&&c<=53&&d>=0&&d<=6?function(e,t,n){let a=new Date(0);a.setUTCFullYear(e,0,4);let s=a.getUTCDay()||7;return a.setUTCDate(a.getUTCDate()+((t-1)*7+n+1-s)),a}(t,c,d):new Date(NaN);{let e=new Date(0);return i>=0&&i<=11&&l>=1&&l<=(o[i]||(m(t)?29:28))&&s>=1&&s<=(m(t)?366:365)?(e.setUTCFullYear(t,i,Math.max(s,l)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);let p=s.getTime(),g=0;if(x.time&&isNaN(g=function(e){let t=e.match(l);if(!t)return NaN;let n=d(t[1]),s=d(t[2]),i=d(t[3]);return(24===n?0===s&&0===i:i>=0&&i<60&&s>=0&&s<60&&n>=0&&n<25)?n*a.vh+s*a.yJ+1e3*i:NaN}(x.time)))return new Date(NaN);if(x.timezone){if(isNaN(h=function(e){if("Z"===e)return 0;let t=e.match(c);if(!t)return 0;let n="+"===t[1]?-1:1,s=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return i>=0&&i<=59?n*(s*a.vh+i*a.yJ):NaN}(x.timezone)))return new Date(NaN)}else{let e=new Date(p+g),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(p+g+h)}let i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,c=/^([+-])(\d{2})(?::?(\d{2}))?$/;function u(e){return e?parseInt(e):1}function d(e){return e&&parseFloat(e.replace(",","."))||0}let o=[31,null,31,30,31,30,31,31,30,31,30,31];function m(e){return e%400==0||e%4==0&&e%100!=0}}},function(e){e.O(0,[7230,4875,2859,4122,1013,4270,5859,2971,2117,1744],function(){return e(e.s=89311)}),_N_E=e.O()}]);