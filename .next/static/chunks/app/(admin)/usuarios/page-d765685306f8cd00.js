(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1210],{1618:function(e,t,s){Promise.resolve().then(s.bind(s,8789))},8789:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var n=s(7437),a=s(2265),l=s(521),i=s(8614),r=s(4286),c=s(8906),o=s(2369),u=s(5302),d=s(5131),h=s(1723),x=s(7806),m=s(3247),p=s(7684),b=s(4270),g=s(4362),f=s(9102),v=s(1001);let j=e=>{let{role:t}=e,{label:s,icon:a,class:l}={admin:{label:"Admin",icon:r.Z,class:"bg-purple-100 text-purple-700"},supervisor:{label:"Supervisor",icon:c.Z,class:"bg-blue-100 text-blue-700"},evaluator:{label:"Avaliador",icon:o.Z,class:"bg-green-100 text-green-700"},client:{label:"Cliente",icon:o.Z,class:"bg-brand-100 text-brand-700"},nurse:{label:"Enfermeiro",icon:o.Z,class:"bg-teal-100 text-teal-700"},caregiver:{label:"Cuidador",icon:o.Z,class:"bg-orange-100 text-orange-700"},nurse_tech:{label:"T\xe9c. Enfermagem",icon:o.Z,class:"bg-cyan-100 text-cyan-700"},physiotherapist:{label:"Fisioterapeuta",icon:o.Z,class:"bg-lime-100 text-lime-700"},nutritionist:{label:"Nutricionista",icon:o.Z,class:"bg-amber-100 text-amber-700"},psychologist:{label:"Psic\xf3logo",icon:o.Z,class:"bg-pink-100 text-pink-700"},speech_therapist:{label:"Fonoaudi\xf3logo",icon:o.Z,class:"bg-violet-100 text-violet-700"},occupational_therapist:{label:"Ter. Ocupacional",icon:o.Z,class:"bg-rose-100 text-rose-700"},physician:{label:"M\xe9dico",icon:o.Z,class:"bg-indigo-100 text-indigo-700"}}[t];return(0,n.jsxs)("span",{className:(0,v.cn)("badge",l),children:[(0,n.jsx)(a,{className:"w-3 h-3 mr-1"}),s]})},N=e=>{let{status:t}=e,{label:s,icon:a,class:l}={active:{label:"Ativo",icon:u.Z,class:"bg-success-100 text-success-700"},inactive:{label:"Inativo",icon:d.Z,class:"bg-neutral-100 text-neutral-600"},blocked:{label:"Bloqueado",icon:d.Z,class:"bg-danger-100 text-danger-700"},pending:{label:"Pendente",icon:h.Z,class:"bg-warning-100 text-warning-700"}}[t];return(0,n.jsxs)("span",{className:(0,v.cn)("badge",l),children:[(0,n.jsx)(a,{className:"w-3 h-3 mr-1"}),s]})};function y(){let{isLoading:e,isAuthorized:t}=(0,g.QL)("canManageUsers"),s=(0,b.t)(),[r,c]=(0,a.useState)(""),[u,d]=(0,a.useState)("all"),[h,y]=(0,a.useState)("all"),[w,A]=(0,a.useState)(!1),[C,Z]=(0,a.useState)(null),E=s.getAllUsers().filter(e=>{let t=e.fullName.toLowerCase().includes(r.toLowerCase())||e.email.toLowerCase().includes(r.toLowerCase())||e.cpf.includes(r),s="all"===u||e.role===u,n="all"===h||e.status===h;return t&&s&&n});return e?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"})}):t?(0,n.jsxs)("div",{className:"min-h-screen bg-neutral-50",children:[(0,n.jsx)("div",{className:"bg-white border-b border-neutral-200 sticky top-0 z-10",children:(0,n.jsxs)("div",{className:"container-mobile py-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-neutral-900",children:"Usu\xe1rios"}),(0,n.jsxs)(l.E.button,{whileTap:{scale:.95},onClick:()=>A(!0),className:"btn-primary flex items-center gap-2",children:[(0,n.jsx)(x.Z,{className:"w-5 h-5"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Novo Usu\xe1rio"})]})]}),(0,n.jsxs)("div",{className:"relative mb-4",children:[(0,n.jsx)(m.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,n.jsx)("input",{type:"text",placeholder:"Buscar por nome, email ou CPF...",value:r,onChange:e=>c(e.target.value),className:"input-base pl-10"})]}),(0,n.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[(0,n.jsxs)("select",{value:u,onChange:e=>d(e.target.value),className:"px-3 py-2 rounded-lg border border-neutral-300 text-sm bg-white",children:[(0,n.jsx)("option",{value:"all",children:"Todos os perfis"}),(0,n.jsx)("option",{value:"admin",children:"Admin"}),(0,n.jsx)("option",{value:"supervisor",children:"Supervisor"}),(0,n.jsx)("option",{value:"evaluator",children:"Avaliador"})]}),(0,n.jsxs)("select",{value:h,onChange:e=>y(e.target.value),className:"px-3 py-2 rounded-lg border border-neutral-300 text-sm bg-white",children:[(0,n.jsx)("option",{value:"all",children:"Todos os status"}),(0,n.jsx)("option",{value:"active",children:"Ativos"}),(0,n.jsx)("option",{value:"inactive",children:"Inativos"}),(0,n.jsx)("option",{value:"blocked",children:"Bloqueados"})]})]})]})}),(0,n.jsxs)("div",{className:"container-mobile py-4",children:[(0,n.jsxs)("p",{className:"text-sm text-neutral-500 mb-4",children:[E.length," usu\xe1rio",1!==E.length?"s":""," encontrado",1!==E.length?"s":""]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)(i.M,{mode:"popLayout",children:E.map((e,t)=>(0,n.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{delay:.05*t},className:"card",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:(0,v.cn)("w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold","active"===e.status?"bg-brand-100 text-brand-600":"bg-neutral-100 text-neutral-400"),children:e.fullName.split(" ").map(e=>e[0]).slice(0,2).join("")}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium text-neutral-900",children:e.fullName}),(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:e.email})]})]}),(0,n.jsx)("button",{onClick:()=>Z(e),className:"p-2 text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100 rounded-lg",children:(0,n.jsx)(p.Z,{className:"w-5 h-5"})})]}),(0,n.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,n.jsx)(j,{role:e.role}),(0,n.jsx)(N,{status:e.status})]}),(0,n.jsx)("div",{className:"mt-3 pt-3 border-t border-neutral-100 text-xs text-neutral-400",children:(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:["Criado: ",(0,f.p6)(e.createdAt)]}),e.lastLoginAt&&(0,n.jsxs)("span",{children:["\xdaltimo acesso: ",(0,f.zg)(e.lastLoginAt)]})]})})]},e.id))}),0===E.length&&(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)(o.Z,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-neutral-500",children:"Nenhum usu\xe1rio encontrado"})]})]})]})]}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("p",{className:"text-neutral-500",children:"Voc\xea n\xe3o tem permiss\xe3o para acessar esta p\xe1gina."})})}},4362:function(e,t,s){"use strict";s.d(t,{Ho:function(){return o},QL:function(){return d},aC:function(){return u}});var n=s(7437),a=s(2265),l=s(9376),i=s(4270);let r=(0,a.createContext)(null),c=["/login","/forgot-pin","/"];function o(e){let{children:t}=e,s=(0,l.useRouter)(),o=(0,l.usePathname)(),u=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t(!0)},[]),e}(),d=(0,i.t)(),[h,x]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null),[b,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!u)return;let e=setTimeout(()=>{(0,i.v)().then(()=>{g(!0)})},100);return()=>clearTimeout(e)},[u]),(0,a.useEffect)(()=>{if(!b)return;let e=()=>{if(!d.checkSession()&&!c.includes(o)){s.push("/login");return}if(d.session){let e=new Date(d.session.expiresAt).getTime()-Date.now();p(e),x(e>0&&e<3e5)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[b,o,s,d]),(0,a.useEffect)(()=>{if(!d.isAuthenticated)return;let e=()=>{d.recordActivity()},t=["mousedown","keydown","touchstart","scroll"];return t.forEach(t=>{window.addEventListener(t,e,{passive:!0})}),()=>{t.forEach(t=>{window.removeEventListener(t,e)})}},[d.isAuthenticated,d]),(0,a.useEffect)(()=>{if(!b)return;let e=c.includes(o);d.isAuthenticated||e?d.isAuthenticated&&"/login"===o&&s.push("/"):s.push("/login")},[b,d.isAuthenticated,o,s]);let f=(0,a.useCallback)(async e=>{let t=await d.loginWithPin(e);return t.success&&s.push("/"),t},[d,s]),v=(0,a.useCallback)(()=>{d.logout(),s.push("/login")},[d,s]),j=(0,a.useCallback)(()=>{d.refreshSession(),x(!1)},[d]),N=(0,a.useCallback)(e=>d.hasPermission(e),[d]),y={user:d.getCurrentUser(),isAuthenticated:d.isAuthenticated,isLoading:!b,permissions:d.getPermissions(),login:f,logout:v,hasPermission:N,showSessionWarning:h,sessionExpiresIn:m,extendSession:j};return(0,n.jsx)(r.Provider,{value:y,children:t})}function u(){let e=(0,a.useContext)(r);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}function d(e){let{isAuthenticated:t,isLoading:s,hasPermission:n}=u(),i=(0,l.useRouter)();return(0,a.useEffect)(()=>{if(!s){if(!t){i.push("/login");return}e&&!n(e)&&i.push("/unauthorized")}},[t,s,e,n,i]),{isLoading:s,isAuthorized:t&&(!e||n(e))}}},1001:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var n=s(1994),a=s(3335);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,n.W)(t))}},9102:function(e,t,s){"use strict";s.d(t,{Fw:function(){return o},p6:function(){return r},zg:function(){return c}});var n=s(936),a=s(4122),l=s(8442),i=s(4862);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd/MM/yyyy",s="string"==typeof e?(0,n.D)(e):e;return(0,a.WU)(s,t,{locale:i.F})}function c(e){let t="string"==typeof e?(0,n.D)(e):e;return(0,l.Q)(t,{locale:i.F,addSuffix:!0})}function o(e){let t=new Date,s=t.getFullYear()-e.getFullYear(),n=t.getMonth()-e.getMonth();return(n<0||0===n&&t.getDate()<e.getDate())&&s--,s}}},function(e){e.O(0,[6137,7230,4875,2859,4122,9179,1519,4270,2971,2117,1744],function(){return e(e.s=1618)}),_N_E=e.O()}]);